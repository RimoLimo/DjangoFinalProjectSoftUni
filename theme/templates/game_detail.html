{% extends "base.html" %}
{% block content %}
<div class="max-w-4xl mx-auto bg-white p-6 rounded shadow mt-6">
  <h1 class="text-3xl font-bold mb-4">{{ game.title }}</h1>
  <img src="{{ game.cover_image_url }}" alt="{{ game.title }}" class="w-full h-64 object-cover rounded mb-6">
  <p class="mb-4">{{ game.description }}</p>
  <p><strong>Genre:</strong> {{ game.genre.name }}</p>
    {% if user.is_authenticated %}
  <a href="{% url 'game-edit' game.pk %}"
     class="inline-block bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded mr-2">
     Edit
  </a>
{% endif %}
    {% if user.is_authenticated %}
  <a href="{% url 'review-add' %}?game={{ game.id }}"
     class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
    Write a Review
  </a>
{% else %}
  <p><a href="{% url 'login' %}">Log in</a> to write a review.</p>
{% endif %}

  {% if user.is_superuser %}
    <a href="{% url 'game-delete' game.pk %}" class="text-red-600 hover:underline mt-4 inline-block">Delete Game</a>
  {% endif %}

  <a href="{% url 'game-list' %}" class="text-blue-500 hover:underline mt-4 inline-block">Back to list</a>
</div>
    <h2 class="text-xl font-semibold mt-8 mb-4">Reviews</h2>

{% if reviews %}
  <ul class="space-y-4">
    {% for review in reviews %}
      <li class="p-4 border rounded bg-gray-100">
        <div class="flex justify-between items-center mb-1">
          <strong>{{ review.user.username }}</strong>
          <span class="text-sm text-gray-500">{{ review.created_at|date:"F j, Y" }}</span>
        </div>
        <div class="text-yellow-600 font-semibold mb-1">Rating: {{ review.rating }}/10</div>
        <h3 class="font-bold text-lg">{{ review.title }}</h3>
        <p>{{ review.content|linebreaks }}</p>

        {% if request.user == review.user %}
          <div class="mt-2">
            <a href="{% url 'review-edit' review.pk %}" class="text-blue-500 hover:underline mr-4">Edit</a>
            <a href="{% url 'review-delete' review.pk %}" class="text-red-500 hover:underline">Delete</a>
          </div>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No reviews yet for this game.</p>
{% endif %}


{% endblock %}
